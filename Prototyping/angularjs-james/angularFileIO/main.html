<html>

<head>
  <title>JavaScript Data Request</title>

</head>

<body>
  <h2>Javascript File IO with Papa Parse</h2>

  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
  <script src="http://127.0.0.1/~MarbleCake/papaparse.js" type="text/javascript"></script>
  <script src="http://127.0.0.1/~MarbleCake/data.js" type="text/javascript"></script>
  <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>

  <div ng-app="mainApp" ng-controller="incomeController">

    <!- Input ->
    Enter a number of a county:
    <input type="number" ng-model="countyNum">
    <button ng-click="update()">Submit</button>

    <!- Outputs ->
    <table border="0">

      <tr>
        <td>Area Name: </td>
        <td>{{areaName}}</td>
      </tr>

      <tr>
        <td>Median Household Income: </td>
        <td>{{medianHHIncome}}</td>
      </tr>

      <tr>
        <td>Median Property Value: </td>
        <td>{{medianProperty}}</td>
      </tr>

    </table>
  </div>

  <!- Controller ->
  <script>
    var incomeJSON;
    var propertyJSON;

    // Papa Parse Median Income Data
    Papa.parse(incomeData,
      {
        header: true,
        dynmicTyping: true,
        complete: function (results) {
          incomeJSON = JSON.parse(JSON.stringify(results.data));
          console.log(incomeJSON)
        }
      });

      // Papa Parse Median Property Value
      Papa.parse(propertyData,
      {
        header: true,
        dynamicTyping: true,
        complete: function (results) {
          propertyJSON = JSON.parse(JSON.stringify(results.data))
          console.log(propertyJSON)
        }
      });

    // Controller
    var mainApp = angular.module("mainApp", []);

    mainApp.controller('incomeController', function ($scope) {
      // Default Values
      $scope.countyNum = 0;
      $scope.areaName = "Autauga County, AL";
      $scope.medianHHIncome = "54487";
      $scope.medianProperty = "141000";

      $scope.update = function () {
        $scope.areaName = incomeJSON[$scope.countyNum].Area_name;
        $scope.medianHHIncome = incomeJSON[$scope.countyNum].Median_Household_Income_2016;
        $scope.medianProperty = propertyJSON[$scope.countyNum].Median_Property_Value_2016;
      }
    });
  </script>

</body>

</html>